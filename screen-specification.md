# 営業日報システム 画面定義書

## 目次
1. [画面一覧](#画面一覧)
2. [画面詳細](#画面詳細)
   - [S-01 ログイン画面](#s-01-ログイン画面)
   - [S-02 ダッシュボード](#s-02-ダッシュボード)
   - [S-03 日報一覧画面](#s-03-日報一覧画面)
   - [S-04 日報作成・編集画面](#s-04-日報作成編集画面)
   - [S-05 日報詳細画面](#s-05-日報詳細画面)
   - [S-06 顧客一覧画面](#s-06-顧客一覧画面)
   - [S-07 顧客登録・編集画面](#s-07-顧客登録編集画面)
   - [S-08 営業マスタ一覧画面](#s-08-営業マスタ一覧画面)
   - [S-09 営業マスタ登録・編集画面](#s-09-営業マスタ登録編集画面)

---

## 画面一覧

| 画面ID | 画面名 | アクセス権限 | 備考 |
|--------|--------|--------------|------|
| S-01 | ログイン画面 | 全員 | 認証前 |
| S-02 | ダッシュボード | 営業・上長・管理者 | ホーム画面 |
| S-03 | 日報一覧画面 | 営業・上長・管理者 | 自分/部下の日報 |
| S-04 | 日報作成・編集画面 | 営業・上長 | 日報の登録・更新 |
| S-05 | 日報詳細画面 | 営業・上長・管理者 | コメント機能含む |
| S-06 | 顧客一覧画面 | 営業・上長・管理者 | 顧客マスタ参照 |
| S-07 | 顧客登録・編集画面 | 営業・上長・管理者 | 顧客マスタ更新 |
| S-08 | 営業マスタ一覧画面 | 管理者 | 社員情報参照 |
| S-09 | 営業マスタ登録・編集画面 | 管理者 | 社員情報更新 |

---

## 画面詳細

### S-01 ログイン画面

#### 概要
システムへのログイン認証を行う画面

#### アクセス権限
- 全ユーザー（認証前）

#### 画面項目

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| メールアドレス | email | text | ○ | ログインID |
| パスワード | password | password | ○ | マスク表示 |
| ログインボタン | btn_login | button | - | - |

#### 主要機能
- メールアドレスとパスワードによる認証
- ログイン成功時はダッシュボード（S-02）へ遷移
- ログイン失敗時はエラーメッセージ表示

#### バリデーション
- メールアドレス: メール形式チェック
- パスワード: 未入力チェック
- 認証失敗時: 「メールアドレスまたはパスワードが正しくありません」

#### 画面遷移
- ログイン成功 → S-02 ダッシュボード

---

### S-02 ダッシュボード

#### 概要
ログイン後のホーム画面。各機能へのナビゲーションと概要情報を表示

#### アクセス権限
- 営業、上長、管理者

#### 画面項目

| セクション | 項目名 | 内容 |
|-----------|--------|------|
| ヘッダー | ユーザー名 | ログインユーザー名を表示 |
| ヘッダー | ログアウトボタン | ログアウト処理 |
| メインメニュー | 日報作成ボタン | S-04へ遷移 |
| メインメニュー | 日報一覧ボタン | S-03へ遷移 |
| メインメニュー | 顧客一覧ボタン | S-06へ遷移 |
| メインメニュー | 営業マスタボタン | S-08へ遷移（管理者のみ） |
| サマリー | 今週の日報提出状況 | 本人の提出済み日数/営業日数 |
| サマリー | 未読コメント件数 | 上長からのコメントで未読のもの |
| サマリー | 部下の日報状況 | 上長の場合、部下の提出状況 |

#### 主要機能
- 各機能へのクイックアクセス
- 日報提出状況のサマリー表示
- 上長の場合、部下の日報状況を確認可能

#### 画面遷移
- 日報作成ボタン → S-04 日報作成・編集画面
- 日報一覧ボタン → S-03 日報一覧画面
- 顧客一覧ボタン → S-06 顧客一覧画面
- 営業マスタボタン → S-08 営業マスタ一覧画面

---

### S-03 日報一覧画面

#### 概要
日報の一覧を表示し、検索・絞り込みを行う画面

#### アクセス権限
- 営業: 自分の日報のみ閲覧
- 上長: 自分と部下の日報を閲覧
- 管理者: 全日報を閲覧

#### 検索条件

| 項目名 | 項目ID | 型 | 備考 |
|--------|--------|-----|------|
| 報告日（From） | date_from | date | 期間指定 |
| 報告日（To） | date_to | date | 期間指定 |
| 営業担当者 | employee_id | select | 上長・管理者のみ |
| 検索ボタン | btn_search | button | - |
| クリアボタン | btn_clear | button | 条件クリア |

#### 一覧表示項目

| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 報告日 | report_date | YYYY/MM/DD形式 |
| 営業担当者 | employee_name | 上長・管理者の場合表示 |
| 訪問件数 | visit_count | その日の訪問記録数 |
| コメント数 | comment_count | 上長からのコメント数 |
| 未読コメント | unread_badge | 未読があればバッジ表示 |
| 操作 | - | 詳細ボタン、編集ボタン |

#### 主要機能
- 日報の一覧表示（ページネーション）
- 期間・担当者による絞り込み検索
- 詳細画面（S-05）への遷移
- 編集画面（S-04）への遷移（自分の日報のみ）
- 新規作成ボタン → S-04へ遷移

#### 画面遷移
- 詳細ボタン → S-05 日報詳細画面
- 編集ボタン → S-04 日報作成・編集画面（編集モード）
- 新規作成ボタン → S-04 日報作成・編集画面（新規モード）

---

### S-04 日報作成・編集画面

#### 概要
日報の新規作成または既存日報の編集を行う画面

#### アクセス権限
- 営業、上長（自分の日報のみ）

#### 画面モード
- **新規作成モード**: 新しい日報を作成
- **編集モード**: 既存の日報を編集

#### 基本情報

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| 報告日 | report_date | date | ○ | 初期値：当日 |
| 営業担当者 | employee_name | text | - | 表示のみ（自動設定） |

#### 訪問記録セクション（動的追加）

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| 顧客名 | customer_id | select | ○ | 顧客マスタから選択 |
| 訪問時刻 | visit_time | time | ○ | HH:MM形式 |
| 訪問内容 | visit_content | textarea | ○ | 500文字以内 |
| 追加ボタン | btn_add_visit | button | - | 訪問記録行を追加 |
| 削除ボタン | btn_delete_visit | button | - | 該当行を削除 |

#### Problem / Plan セクション

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| 今日の課題・相談 (Problem) | problem | textarea | - | 1000文字以内 |
| 明日の予定 (Plan) | plan | textarea | - | 1000文字以内 |

#### 操作ボタン

| ボタン名 | 機能 |
|---------|------|
| 保存ボタン | 日報を保存してS-05へ遷移 |
| キャンセルボタン | 入力内容を破棄してS-03へ戻る |

#### 主要機能
- 日報基本情報の入力
- 訪問記録の動的追加・削除（最低1件必須）
- Problem（課題・相談）、Plan（明日の予定）の入力
- 顧客は顧客マスタから選択（プルダウン or オートコンプリート）

#### バリデーション
- 報告日: 必須、日付形式チェック
- 訪問記録: 最低1件必須
- 顧客名: 必須
- 訪問時刻: 必須、時刻形式チェック
- 訪問内容: 必須、500文字以内
- Problem/Plan: 1000文字以内

#### 画面遷移
- 保存成功 → S-05 日報詳細画面
- キャンセル → S-03 日報一覧画面

---

### S-05 日報詳細画面

#### 概要
日報の詳細情報を表示し、上長がコメントを投稿できる画面

#### アクセス権限
- 営業: 自分の日報のみ閲覧
- 上長: 自分と部下の日報を閲覧・コメント
- 管理者: 全日報を閲覧・コメント

#### 基本情報表示

| 項目名 | 表示内容 |
|--------|----------|
| 報告日 | report_date |
| 営業担当者 | employee_name |
| 作成日時 | created_at |
| 更新日時 | updated_at |

#### 訪問記録表示（テーブル形式）

| 列名 | 内容 |
|------|------|
| 訪問時刻 | visit_time |
| 顧客名 | customer_name |
| 訪問内容 | visit_content |

#### Problem / Plan 表示

| セクション | 内容 |
|-----------|------|
| 今日の課題・相談 (Problem) | problem |
| 明日の予定 (Plan) | plan |

#### コメントセクション

##### コメント一覧表示

| 項目 | 内容 |
|------|------|
| コメント者名 | commenter_name |
| コメント内容 | comment_content |
| 投稿日時 | created_at |

##### コメント投稿フォーム（上長・管理者のみ）

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| コメント内容 | comment_content | textarea | ○ | 500文字以内 |
| 投稿ボタン | btn_post_comment | button | - | - |

#### 操作ボタン

| ボタン名 | 表示条件 | 機能 |
|---------|---------|------|
| 編集ボタン | 自分の日報の場合 | S-04へ遷移（編集モード） |
| 削除ボタン | 自分の日報の場合 | 日報を削除（確認ダイアログ表示） |
| 戻るボタン | 全員 | S-03へ戻る |

#### 主要機能
- 日報の詳細情報表示
- 訪問記録の一覧表示
- コメントの一覧表示
- 上長・管理者によるコメント投稿
- 自分の日報の場合、編集・削除が可能

#### バリデーション
- コメント内容: 必須、500文字以内

#### 画面遷移
- 編集ボタン → S-04 日報作成・編集画面（編集モード）
- 戻るボタン → S-03 日報一覧画面
- 削除成功 → S-03 日報一覧画面

---

### S-06 顧客一覧画面

#### 概要
顧客マスタの一覧を表示し、検索・管理を行う画面

#### アクセス権限
- 営業、上長、管理者

#### 検索条件

| 項目名 | 項目ID | 型 | 備考 |
|--------|--------|-----|------|
| 顧客名 | customer_name | text | 部分一致検索 |
| 担当営業 | employee_id | select | プルダウン選択 |
| 検索ボタン | btn_search | button | - |
| クリアボタン | btn_clear | button | 条件クリア |

#### 一覧表示項目

| 項目名 | 表示内容 |
|--------|----------|
| 顧客ID | customer_id |
| 顧客名 | customer_name |
| 電話番号 | phone |
| メールアドレス | email |
| 担当営業 | assigned_employee_name |
| 操作 | 編集ボタン、削除ボタン |

#### 主要機能
- 顧客の一覧表示（ページネーション）
- 顧客名・担当営業による検索
- 新規顧客登録（S-07へ遷移）
- 顧客情報の編集（S-07へ遷移）
- 顧客の削除（確認ダイアログ表示）

#### 画面遷移
- 新規登録ボタン → S-07 顧客登録・編集画面（新規モード）
- 編集ボタン → S-07 顧客登録・編集画面（編集モード）

---

### S-07 顧客登録・編集画面

#### 概要
顧客マスタの新規登録または既存顧客情報の編集を行う画面

#### アクセス権限
- 営業、上長、管理者

#### 画面モード
- **新規登録モード**: 新しい顧客を登録
- **編集モード**: 既存の顧客情報を編集

#### 入力項目

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| 顧客名 | customer_name | text | ○ | 100文字以内 |
| 住所 | address | text | - | 200文字以内 |
| 電話番号 | phone | text | - | ハイフンあり/なし両対応 |
| メールアドレス | email | text | - | メール形式チェック |
| 担当営業 | assigned_employee_id | select | ○ | 営業マスタから選択 |

#### 操作ボタン

| ボタン名 | 機能 |
|---------|------|
| 保存ボタン | 顧客情報を保存してS-06へ遷移 |
| キャンセルボタン | 入力内容を破棄してS-06へ戻る |

#### 主要機能
- 顧客基本情報の入力
- 担当営業の選択
- 入力内容のバリデーション

#### バリデーション
- 顧客名: 必須、100文字以内
- 住所: 200文字以内
- 電話番号: 数字とハイフンのみ
- メールアドレス: メール形式チェック
- 担当営業: 必須

#### 画面遷移
- 保存成功 → S-06 顧客一覧画面
- キャンセル → S-06 顧客一覧画面

---

### S-08 営業マスタ一覧画面

#### 概要
営業（社員）マスタの一覧を表示し、管理を行う画面

#### アクセス権限
- 管理者のみ

#### 検索条件

| 項目名 | 項目ID | 型 | 備考 |
|--------|--------|-----|------|
| 社員名 | name | text | 部分一致検索 |
| 部署 | department | select | プルダウン選択 |
| 検索ボタン | btn_search | button | - |
| クリアボタン | btn_clear | button | 条件クリア |

#### 一覧表示項目

| 項目名 | 表示内容 |
|--------|----------|
| 社員ID | employee_id |
| 社員名 | name |
| メールアドレス | email |
| 部署 | department |
| 役職 | position |
| 上長名 | manager_name |
| 操作 | 編集ボタン、削除ボタン |

#### 主要機能
- 社員の一覧表示（ページネーション）
- 社員名・部署による検索
- 新規社員登録（S-09へ遷移）
- 社員情報の編集（S-09へ遷移）
- 社員の削除（確認ダイアログ表示）

#### 画面遷移
- 新規登録ボタン → S-09 営業マスタ登録・編集画面（新規モード）
- 編集ボタン → S-09 営業マスタ登録・編集画面（編集モード）

---

### S-09 営業マスタ登録・編集画面

#### 概要
営業（社員）マスタの新規登録または既存社員情報の編集を行う画面

#### アクセス権限
- 管理者のみ

#### 画面モード
- **新規登録モード**: 新しい社員を登録
- **編集モード**: 既存の社員情報を編集

#### 入力項目

| 項目名 | 項目ID | 型 | 必須 | 備考 |
|--------|--------|-----|------|------|
| 社員名 | name | text | ○ | 50文字以内 |
| メールアドレス | email | text | ○ | ログインIDとして使用 |
| パスワード | password | password | △ | 新規登録時のみ必須 |
| パスワード（確認） | password_confirm | password | △ | 新規登録時のみ必須 |
| 部署 | department | select | ○ | プルダウン選択 |
| 役職 | position | select | ○ | プルダウン選択 |
| 上長 | manager_id | select | - | 営業マスタから選択 |

#### 操作ボタン

| ボタン名 | 機能 |
|---------|------|
| 保存ボタン | 社員情報を保存してS-08へ遷移 |
| キャンセルボタン | 入力内容を破棄してS-08へ戻る |

#### 主要機能
- 社員基本情報の入力
- パスワードの設定（新規登録時）
- 上長の選択
- 入力内容のバリデーション

#### バリデーション
- 社員名: 必須、50文字以内
- メールアドレス: 必須、メール形式チェック、重複チェック
- パスワード: 新規登録時必須、8文字以上、英数字含む
- パスワード（確認）: パスワードと一致すること
- 部署: 必須
- 役職: 必須

#### 画面遷移
- 保存成功 → S-08 営業マスタ一覧画面
- キャンセル → S-08 営業マスタ一覧画面

---

## 画面遷移図

```
S-01 ログイン
    ↓
S-02 ダッシュボード ←→ S-03 日報一覧 ←→ S-04 日報作成・編集
    ↓                                ↓
    ↓                            S-05 日報詳細
    ↓
    ↓────→ S-06 顧客一覧 ←→ S-07 顧客登録・編集
    ↓
    └────→ S-08 営業マスタ一覧 ←→ S-09 営業マスタ登録・編集
           (管理者のみ)
```

---

## 共通仕様

### レスポンシブデザイン
- PC、タブレット、スマートフォンに対応
- スマートフォンではテーブル表示を縦スクロール対応

### エラーハンドリング
- バリデーションエラーは該当項目の近くに赤字で表示
- システムエラーはトースト通知で表示
- ネットワークエラーはリトライボタン付きダイアログ表示

### ローディング表示
- データ取得中はローディングスピナーを表示
- ボタン押下時は二重送信防止のため非活性化

### 確認ダイアログ
- 削除操作時は「本当に削除しますか？」の確認ダイアログを表示
- データ未保存時の画面遷移は確認ダイアログを表示

---

## 改訂履歴

| 版数 | 改訂日 | 改訂者 | 改訂内容 |
|------|--------|--------|----------|
| 1.0 | 2026-01-04 | - | 初版作成 |
